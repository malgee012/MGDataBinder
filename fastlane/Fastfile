
desc 'UCLib é’ˆå¯¹ç§æœ‰åº“å¿«é€Ÿå‡çº§ç»´æŠ¤ eg: fastlane UCLib target:MGDataBinder tag:1.0.0.3 msg:æ–°å¢æ¨¡å‹æ•°ç»„æ–¹æ³•'
lane :UCLib do |options|

# æ‰“æ ‡ç­¾éœ€è¦å’Œpodspecçš„ç‰ˆæœ¬å¯¹åº”
tagName = options[:tag]
# è¢«ä¸Šä¼ çš„ç›®æ ‡podspecæ–‡ä»¶
targetName = options[:target]
# æœ¬æ¬¡æ›´æ–°çš„å†…å®¹
msgName = options[:msg]

# pod install ï¼ˆä½¿Exampleä¸podä¸‹æ¥çš„åº“äº§ç”Ÿå…³è”ï¼‰
cocoapods(
clean: true,
podfile: "./Example/Podfile"
)

pod_lib_lint(
	# sources: ['http://gitlab.umooc.com.cn/malgee/umspecs.git','https://cdn.cocoapods.org/'],
	allow_warnings: true, 
	verbose: true,
	no_clean: true,
	use_libraries: true
	)

git_add(path: ".")
git_commit(path: ".", message: "#{msgName}")

push_to_git_remote


if git_tag_exists(tag: tagName)
    UI.message("å‘ç°tag:#{tagName} ä¹‹å‰æœ‰tag,åˆ é™¤åŸæ¥çš„æ ‡ç­¾ğŸš€")
    remove_tag(tag:tagName)
end

# æ‰“æ ‡ç­¾
add_git_tag(tag: tagName)
push_git_tags

pod_push(
	path: "#{targetName}.podspec", 
	repo: "UCSpecs", 
	verbose: true,
	allow_warnings: true,
	use_libraries: true,
	# sources: ['http://gitlab.umooc.com.cn/malgee/umspecs.git','https://cdn.cocoapods.org/'],
	# use_libraries:true
	)

end
